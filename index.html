<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rezepte-Challenge Formular</title>
  <style>
    body { font-family: sans-serif; background: #f3f4f6; margin: 0; padding: 2rem; }
    .container, .lang-toggle { max-width: 900px; margin: 0 auto 1.5rem auto; width: 100%; }
    .container { background: #fff; padding: 2rem; border-radius: 16px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }

    label { display: block; margin-top: 1rem; font-weight: bold; }
    input, textarea, select { width: 100%; max-width: 100%; padding: 0.5rem; margin-top: 0.25rem; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
    table { width: 100%; max-width: 900px; border-collapse: collapse; margin-top: 1rem; overflow-x: auto; display: block; }
    th, td { border: 1px solid #e5e7eb; padding: 0.5rem; text-align: left; }
    th { background-color: #f9fafb; }
    button { margin-top: 2rem; width: 100%; padding: 0.75rem; font-size: 1rem; background-color: #2563eb; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
    button:hover { background-color: #1e40af; }
    .note { font-size: 0.85rem; color: #555; margin-top: 1rem; }

    /* Leitfäden als Bilder */
    .guides { margin-top: 0; margin-bottom: 1.75rem; } /* EXTRA Abstand nach unten zum Formular */
    .guide { margin-bottom: 1.25rem; } /* Abstand zwischen den beiden Bildern */
    .guide a { display: block; }
    .guide img {
      width: 100%; height: auto; display: block;
      border: 1px solid #e5e7eb; border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .guide .link-row { margin-top: 0.4rem; font-size: 0.95rem; }
    .guide .link-row a { text-decoration: none; }

    @media (max-width: 768px) {
      body { padding: 1rem; }
      .container, .lang-toggle { padding: 1rem; }
      th, td { font-size: 0.9rem; }
      button { font-size: 0.95rem; }
    }
  </style>
</head>
<body>
  <div class="lang-toggle">
    <button onclick="switchLanguage()">DE / EN</button>
  </div>

  <!-- Leitfäden als Bilder (ohne Titel) -->
  <div class="container guides" id="guides-container">
    <div class="guide">
      <a id="img1-link" href="#" target="_blank" rel="noopener">
        <img id="img1" alt="Leitfaden Seite 1">
      </a>
      <div class="link-row">
        <span id="img1-link-label">In voller Größe öffnen:</span>
        <a id="img1-direct" href="#" target="_blank" rel="noopener">Bild in neuem Tab</a>
      </div>
    </div>

    <div class="guide">
      <a id="img2-link" href="#" target="_blank" rel="noopener">
        <img id="img2" alt="Leitfaden Seite 2">
      </a>
      <div class="link-row">
        <span id="img2-link-label">In voller Größe öffnen:</span>
        <a id="img2-direct" href="#" target="_blank" rel="noopener">Bild in neuem Tab</a>
      </div>
    </div>
  </div>

  <div class="container">
    <form id="rezeptForm" action="https://formspree.io/f/mpwjeloy" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="_redirect" value="https://rezeptaktion.github.io/rezeptaktion/danke.html">

      <label for="standort" id="label-standort">Lieblingsstandort</label>
      <select id="standort" name="Lieblingsstandort" required>
        <option value="">Bitte auswählen</option>
        <option>Berlin</option>
        <option>MUE03</option>
        <option>Potsdam</option>
        <option>Ratingen</option>
        <option>Rot04</option>
        <option>St. Ingbert</option>
        <option>WDF03</option>
        <option>WDF08</option>
        <option>WDF13</option>
        <option>WDF20</option>
      </select>

      <label for="rezeptname" id="label-rezeptname">Name des Rezepts</label>
      <input type="text" id="rezeptname" name="Rezeptname" required>

      <label for="portionen" id="label-portionen">Anzahl Portionen</label>
      <input type="number" id="portionen" name="AnzahlPortionen" required>

      <label id="label-hauptzutaten">Hauptzutaten</label>
      <table id="zutatenTabelle">
        <thead>
          <tr>
            <th id="th-zutat">Zutat</th>
            <th id="th-menge">Menge (roh)(g)</th>
            <th id="th-zubereitungsart">Zubereitungsart</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="text" name="Zutat_1" oninput="addRowIfNeeded(this)"></td>
            <td><input type="number" name="Menge_1" min="0"></td>
            <td>
              <select name="Zubereitungsart_1">
                <option value="">Bitte auswählen</option>
                <option>Gedämpft</option>
                <option>Gekocht</option>
                <option>Gegart</option>
                <option>Frittiert</option>
                <option>Roh</option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>

      <label for="zutaten" id="label-zutaten">Ergänzende Zutaten (z. B. Gewürze, Kräuter, Garnitur)</label>
      <textarea id="zutaten" name="Ergänzende_Zutaten" rows="3"></textarea>

      <label for="zubereitung" id="label-zubereitung">Zubereitungsart in Stichpunkten (Optional)</label>
      <textarea id="zubereitung" name="Zubereitungsschritte" rows="5"></textarea>

      <label for="bild" id="label-bild">Bild hochladen (optional)</label>
      <input type="file" id="bild" name="Rezeptbild" accept="image/*">

      <label for="name" id="label-name">SAP Mitarbeiter-ID</label>
      <input type="text" id="name" name="MitarbeiterID" required>

      <div class="note" id="note-text">Mit dem Absenden erkläre ich mich damit einverstanden, dass meine Angaben zur Bearbeitung der Aktion gespeichert und per E-Mail übermittelt werden.</div>

      <button type="submit" id="button-submit">Rezept absenden</button>
    </form>
  </div>

<script>
let zeilenIndex = 1;
let currentLang = document.documentElement.lang || 'de';

/* ====== Bild-Dateien (genaue Dateinamen wie abgelegt) ======
   Achtung: Eine Datei hat ".pdf" im Namen – bitte exakt so liegen lassen. */
const imgFiles = {
  de: [
    "SAP-Eat green  & create-Challenge.pdf Seite 1 Deutsch-1.jpg",
    "SAP-Eat green  & create-Challenge Seite 2 Deutsch-1.jpg"
  ],
  en: [
    "SAP-Eat green  & create-Challenge Seite 1 Englisch-1.jpg",
    "SAP-Eat green  & create-Challenge Seite 2 Englisch-1.jpg"
  ]
};

function safeUrl(name) {
  return encodeURIComponent(name);
}

function setImagesForLanguage(lang) {
  const [f1, f2] = imgFiles[lang];

  const img1 = document.getElementById('img1');
  const img2 = document.getElementById('img2');
  const img1Link = document.getElementById('img1-link');
  const img2Link = document.getElementById('img2-link');
  const img1Direct = document.getElementById('img1-direct');
  const img2Direct = document.getElementById('img2-direct');

  const url1 = safeUrl(f1);
  const url2 = safeUrl(f2);

  img1.src = url1;
  img2.src = url2;
  img1.alt = (lang === 'en' ? 'Guide Page 1' : 'Leitfaden Seite 1');
  img2.alt = (lang === 'en' ? 'Guide Page 2' : 'Leitfaden Seite 2');

  img1Link.href = url1;
  img2Link.href = url2;
  img1Direct.href = url1;
  img2Direct.href = url2;

  // Texte unter den Bildern
  document.getElementById('img1-link-label').textContent =
    lang === 'en' ? 'Open full size:' : 'In voller Größe öffnen:';
  document.getElementById('img2-link-label').textContent =
    lang === 'en' ? 'Open full size:' : 'In voller Größe öffnen:';
  img1Direct.textContent = lang === 'en' ? 'Open image in new tab' : 'Bild in neuem Tab';
  img2Direct.textContent = lang === 'en' ? 'Open image in new tab' : 'Bild in neuem Tab';
}

/* ====== Zutaten-Tabelle dynamisch ====== */
function addRowIfNeeded(input) {
  const tr = input.closest('tr');
  const tbody = document.getElementById('zutatenTabelle').getElementsByTagName('tbody')[0];
  const letzte = tbody.lastElementChild;
  if (tr === letzte && input.value.trim() !== '') {
    zeilenIndex++;
    const neue = document.createElement('tr');
    neue.innerHTML = generateRowHTML(zeilenIndex);
    tbody.appendChild(neue);
  }
}
function generateRowHTML(index) {
  return `
    <td><input type="text" name="Zutat_${index}" oninput="addRowIfNeeded(this)"></td>
    <td><input type="number" name="Menge_${index}" min="0"></td>
    <td>
      <select name="Zubereitungsart_${index}">
        ${getOptionsHTML()}
      </select>
    </td>`;
}
function getOptionsHTML() {
  return currentLang === 'de'
    ? `<option value="">Bitte auswählen</option>
       <option>Gedämpft</option>
       <option>Gekocht</option>
       <option>Gegart</option>
       <option>Frittiert</option>
       <option>Roh</option>`
    : `<option value="">Please select</option>
       <option>Steamed</option>
       <option>Boiled</option>
       <option>Braised</option>
       <option>Fried</option>
       <option>Raw</option>`;
}
document.getElementById('rezeptForm').addEventListener('submit', function () {
  const tbody = document.getElementById('zutatenTabelle').getElementsByTagName('tbody')[0];
  const inputs = tbody.lastElementChild.querySelectorAll('input, select');
  const allEmpty = Array.from(inputs).every(el => !el.value.trim());
  if (allEmpty) tbody.lastElementChild.remove();
});

/* ====== Sprache umschalten (Bilder + Formtexte) ====== */
function switchLanguage() {
  currentLang = document.documentElement.lang === 'de' ? 'en' : 'de';
  document.documentElement.lang = currentLang;

  // Form labels
  document.getElementById('label-standort').textContent = currentLang === 'en' ? 'Preferred Location' : 'Lieblingsstandort';
  document.getElementById('label-rezeptname').textContent = currentLang === 'en' ? 'Recipe Name' : 'Name des Rezepts';
  document.getElementById('label-portionen').textContent = currentLang === 'en' ? 'Number of Portions' : 'Anzahl Portionen';
  document.getElementById('label-hauptzutaten').textContent = currentLang === 'en' ? 'Main Ingredients' : 'Hauptzutaten';
  document.getElementById('th-zutat').textContent = currentLang === 'en' ? 'Ingredient' : 'Zutat';
  document.getElementById('th-menge').textContent = currentLang === 'en' ? 'Quantity (raw)(g)' : 'Menge (roh)(g)';
  document.getElementById('th-zubereitungsart').textContent = currentLang === 'en' ? 'Preparation Method' : 'Zubereitungsart';
  document.getElementById('label-zutaten').textContent = currentLang === 'en'
    ? 'Additional Ingredients (e.g. spices, herbs, garnish)'
    : 'Ergänzende Zutaten (z. B. Gewürze, Kräuter, Garnitur)';
  document.getElementById('label-zubereitung').textContent = currentLang === 'en'
    ? 'Preparation Steps (Optional)'
    : 'Zubereitungsart in Stichpunkten (Optional)';
  document.getElementById('label-bild').textContent = currentLang === 'en' ? 'Upload Image (optional)' : 'Bild hochladen (optional)';
  document.getElementById('label-name').textContent = currentLang === 'en' ? 'SAP Employee ID' : 'SAP Mitarbeiter-ID';
  document.getElementById('note-text').textContent = currentLang === 'en'
    ? 'By submitting, I agree that my information will be stored and emailed for processing the campaign.'
    : 'Mit dem Absenden erkläre ich mich damit einverstanden, dass meine Angaben zur Bearbeitung der Aktion gespeichert und per E-Mail übermittelt werden.';
  document.getElementById('button-submit').textContent = currentLang === 'en' ? 'Submit Recipe' : 'Rezept absenden';

  // Optionen in bestehenden Selects umstellen
  document.querySelectorAll('#zutatenTabelle select').forEach(select => {
    const selVal = select.value;
    select.innerHTML = getOptionsHTML();
    if (!['Gedämpft','Gekocht','Gegart','Frittiert','Roh','Steamed','Boiled','Braised','Fried','Raw'].includes(selVal)) {
      select.value = '';
    }
  });
  document.getElementById('standort').options[0].textContent = currentLang === 'en' ? 'Please select' : 'Bitte auswählen';

  // Bilder für aktuelle Sprache setzen
  setImagesForLanguage(currentLang);
}

// Initial Bilder setzen (Default: DE)
setImagesForLanguage(currentLang);
</script>
</body>
</html>
